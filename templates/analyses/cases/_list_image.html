<div class="table-responsive">
    <table class="table table-hover table-striped align-middle mb-0">
        <thead class="table-light">
            <tr>
                <th>File name</th>
                <th>Owner</th>
                <th>Submitted at</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% if images %}
                {% for image in images %}
                    <tr>
                        <td>
                            <a href="{% url "show_analysis" image.id %}" class="text-decoration-none fw-bold">{{ image.file_name }}</a></td>
                        <td>{{ image.owner.username }}</td>
                        <td>{{ image.created_at }}</td>
                        <td>
                            <div class="btn-group btn-group-sm">
                                <a class="btn btn-outline-secondary" title="Show preview" href="{% url "image" image.image_id %}" target="_blank">
                                    <i class="fa-solid fa-image"></i>
                                </a>
                                <a class="btn btn-outline-secondary" title="Show analysis" href="{% url "show_analysis" image.id %}">
                                    <i class="fa-solid fa-file-lines"></i>
                                </a>
                                {% if image.favorites.all %}
                                    <button class="btn btn-warning text-white favorite star{{image.id}}" data-url="{% url "favorite" image.id %}" title="Un-set as favorite">
                                        <i class="fa-solid fa-star"></i>
                                    </button>
                                {% else %}
                                    <button class="btn btn-outline-warning favorite star{{image.id}}" data-url="{% url "favorite" image.id %}" title="Set as favorite">
                                        <i class="fa-solid fa-star"></i>
                                    </button>
                                {% endif %}
                            </div>
                        </td>
                    </tr>
                {% endfor %}
            {% else %}
                <tr>
                    <td colspan="4" class="text-center py-4 text-muted">
                        <i class="fa-solid fa-folder-open fa-2x mb-2 d-block"></i>
                        No images found.
                    </td>
                </tr>
            {% endif %}
        </tbody>
    </table>
</div>

<script type="text/javascript">
$('.favorite').click(function(e){
    e.preventDefault();
    var btn = $(this);
    var url = btn.data("url");
    $.ajax({
        type: "GET",
        url: url,
        success: function(){
            // Toggle appearance
            if (btn.hasClass('btn-warning')) {
                btn.removeClass('btn-warning text-white').addClass('btn-outline-warning');
                btn.attr('title', 'Set as favorite');
            } else {
                btn.removeClass('btn-outline-warning').addClass('btn-warning text-white');
                btn.attr('title', 'Un-set as favorite');
            }
        }
    });
});
</script>