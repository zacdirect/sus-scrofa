{% load analyses_tags %}
<div class="card shadow-sm border-0 mb-4">
    <div class="card-header bg-white border-bottom-0 pb-0">
        <ul class="nav nav-tabs card-header-tabs" id="signatureTabs" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="all-tab" data-bs-toggle="tab" data-bs-target="#system-signature" type="button" role="tab" aria-controls="system-signature" aria-selected="true">
                    All <span class="badge bg-secondary ms-1">{{ analysis.report.signatures|length }}</span>
                </button>
            </li>
            {# Show only severities present. #}
            {% if analysis.report.signatures|has_severity:"3" %}
                <li class="nav-item" role="presentation">
                    <button class="nav-link text-danger" id="high-tab" data-bs-toggle="tab" data-bs-target="#high-signature" type="button" role="tab" aria-controls="high-signature" aria-selected="false">
                        High <span class="badge bg-danger ms-1">{{ analysis.report.signatures|count_severity:"3" }}</span>
                    </button>
                </li>
            {% endif %}
            {% if analysis.report.signatures|has_severity:"2" %}
                <li class="nav-item" role="presentation">
                    <button class="nav-link text-warning" id="medium-tab" data-bs-toggle="tab" data-bs-target="#medium-signature" type="button" role="tab" aria-controls="medium-signature" aria-selected="false">
                        Medium <span class="badge bg-warning text-dark ms-1">{{ analysis.report.signatures|count_severity:"2" }}</span>
                    </button>
                </li>
            {% endif %}
            {% if analysis.report.signatures|has_severity:"1" %}
                <li class="nav-item" role="presentation">
                    <button class="nav-link text-success" id="low-tab" data-bs-toggle="tab" data-bs-target="#low-signature" type="button" role="tab" aria-controls="low-signature" aria-selected="false">
                        Low <span class="badge bg-success ms-1">{{ analysis.report.signatures|count_severity:"1" }}</span>
                    </button>
                </li>
            {% endif %}
        </ul>
    </div>
    <div class="card-body">
        <div class="tab-content" id="signatureTabsContent">
            <div class="tab-pane fade show active" id="system-signature" role="tabpanel" aria-labelledby="all-tab">
                <div class="accordion" id="sign-accordion">
                    {% for sign in analysis.report.signatures %}
                        {% include "analyses/report/_signatures_table.html" %}
                    {% endfor %}
                </div>
            </div>
            <div class="tab-pane fade" id="high-signature" role="tabpanel" aria-labelledby="high-tab">
                <div class="accordion" id="sign3-accordion">
                    {% for sign in analysis.report.signatures %}
                        {% if sign.severity == 3 %}
                            {% include "analyses/report/_signatures_table.html" with segment=3 %}
                        {% endif %}
                    {% endfor %}
                </div>
            </div>
            <div class="tab-pane fade" id="medium-signature" role="tabpanel" aria-labelledby="medium-tab">
                <div class="accordion" id="sign2-accordion">
                    {% for sign in analysis.report.signatures %}
                        {% if sign.severity == 2 %}
                            {% include "analyses/report/_signatures_table.html" with segment=2 %}
                        {% endif %}
                    {% endfor %}
                </div>
            </div>
            <div class="tab-pane fade" id="low-signature" role="tabpanel" aria-labelledby="low-tab">
                <div class="accordion" id="sign1-accordion">
                    {% for sign in analysis.report.signatures %}
                        {% if sign.severity == 1 %}
                            {% include "analyses/report/_signatures_table.html" with segment=1 %}
                        {% endif %}
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
</div>